"Hello, welcome again to network security. This lecture is a supplemental on vulnerability scanning and Metasploit. So specifically about talking about tools for people to scanned for vulnerabilities in a target and for how to exploit them. Specifically, we're covering topics such as nurses for vulnerability scanning and Metasploit for exploiting when abilities. But you have a lab assignment are using Metasploit. And probably the absolute best way to learn about Metasploit is to preview the link to Metasploit unleashed. Essentially on this is a free online resource that allows you to teach you how to exploit a vulnerability Ambras point, and it goes through it step-by-step on how to do it. It also covers over some command, some key terms and definitions as well. So that is probably your absolute best resource for using Metasploit. So in, in our class, we kind of talk about two types of attacks. And those type of tax or network-based attacks or client side attacks. And client-side attacks are attacks where the user has to do something to get the exploit to work. And these things will include things such as double-click into an Excel file and enabling macros or word forwarding may enable macros or clicking on a link or tapping into a phishing email their credentials and such that. So these are the client side. The tax and climate, sex outside the texts are very important because client-side attacks goes directly through all the firewalls, auto gateways, and onto a user's computer. Example. Today, most people working from home, so say, a user connects to their work network through their home computer, right through Otzi 365, Outlook or wherever resources since they use at home. So that home, the personal computer. And at the same time, the user goes and loss into Yahoo Mail or Gmail and gets a phishing email or a spear phishing email, the user clicks a link, gets its personal computer compromise. And now that the personal computers compromise, the personal, the malware, the personal computer can take over and start getting into the corporate email, corporate file shares, corporate SharePoint, and so on, go to the corporate VPN and essentially gets access into the network. And, well, phishing emails are quite easy, right? Phishing emails, having website with links on it, advertisement that links up to someplace else. It's very easy. Some tricks I can do iframe, Those are quite old techniques today. The new version of these techniques is perhaps JavaScript advertisements from Google, where, you know the The advertisement has some JavaScript embedded, and somehow they got through the Google filters for ads and was able to install something malicious user or redirect the user to subserve website that might exploit other duties. Here's an example of a client-side attack is a PayPal example. This is a phishing email. Please click this link or else you lose access to your PayPal account. Here's an example of a client side exploit. And DS1 exploits I2. This is a real exploit that worked. So here's how it works. The attacker sends an email to the user, and the user gets an email and a user clicks on the link. The user clicks on the link. The user will make a HTTP request out back to the server, onto the attacker server. And from there, the user will receive a file from the attacker. And this file is the iTunes playlists, receptors, iTunes play, this has a vulnerability and at that, once it gets run, it will exploit iTunes, and therefore it will have the same privileges as iTunes. And then once I too just exploited iTunes for reached back out onto the internet and go back to the attacker. Now, this concept is really important. And the concept is that the malware is reaching back out as a reverse back out to the internet. And the reason for that is that most people here, almost everybody is behind some sort of firewall. So let's say in your corporate network, you're behind the firewall. And we know that. But even uses at home the behind a firewall or there is a network address translation firewall or not, actually the proper term will probably be key pad or port address translation, firewall. So let's say you're at home right now and you are using Verizon files and writing files has this WiFi gateway that they give you. And you just connected to the WiFi gateway. And you only have one IP address for everyone in your home in the same Wi-Fi network. And what don't rising gateway does is that it translates IP addresses into different IP addresses in the local network by translating the port to a particular IP address and port address translation. So in most cases, in both cases, there is a firewall. And with this firewall here, since the firewall doesn't know what's going on, the firewall general, the blocks and the unsolicited traffic. A firewall blocks unsolicited traffic. And it's not really a block at the firewall is blocking and only because it just doesn't know what to do with it, because it's behind the number of hosts behind a firewall or behind the gateway, doesn't know what to do with it, and therefore might be four edges blocks it. So most people behind firewalls anyways. So essentially in order to get bypass firewall, it'll do a reverse conduction because you're revising gateway bullet, everything to go out, whatever it is you want to go out, go out nothing. And so in order to bypass it. Passes it by sending a phishing email, which is actually bypasses the firewall. The user clicks on the phishing email and then the user will make a connection outward the firewall to download the file. Then when the users iTunes gets compromised, iTunes food then again, go out of the firewall to make connection back to the attacker. So it starts the connection back out to the attacker. In order to get the C command and control, you'll have a better voice session or whatever. This is, a very typical malware infection scenario because we are all behind firewalls. Things like emails goes right by the firewall, very easily, schools right by the firewall because what firewater check that sort of stuff. So when you're using Metasploit, it's important that no, you will attempt to use reverse type of payload because that is really what an attacker would use. Now it doesn't matter in the lab because there's no phi y between it. Now, let's talk about some attack, some vulnerability scanners. There's a number of very common when a body scanners necess is probably the most common one, less qual IS kuhn, probably a couple of others. And these vulnerability scanners has gotten really, really good lately. This ability scanners has the ability to not only scan for when abilities from the outside to host, like something that nasa can do. Nurses can scanned for vulnerabilities from outside of the host. It can look at the poets tried to forgot what services are running on it. What version of the service running on it? A puppet that defy the Apache version, that IS version, send bail version and so on. That there's really good. But Nessus and tools, just like that says, are extremely valuable today because not only can they scan the household outside, they can actually be provided credentials and log into the system and find the vulnerabilities from within the system. Example would be, you know, you give it credentials to log into the system. And then from there it goes to the registry. System files, goes through other files, annuity determined what version of software is running in order to identify when a abilities Nessus and unlike also has the ability to install an agent on the target system. And from that agent, there's able to continuously collect data and then report back on when abilities and such. That's just like A2s requires configuration. You can just take Nessus, dump it onto the network, and have it work properly. That is just not possible, right? It takes, it takes a lot of resources to have something like nesters or some sort of scanner running. And so you certainly can't just buy it properly network and be done with it, right? Because you have to configure it, to scan it frequently to gather data, yet to make sure that Nessus is scanning all parts of the network, for example. And again also, this is. Dhcp configured in order for you to be a professional here in, if you're managing something like this is you need to ensure that is configured correctly because the two being not configured correctly would give you poor visual results. And two thicknesses and read cause. Those are these aren't familiar with. After it does scan and a report is generated, it doesn't tell you what the configuration settings are in the report. And therefore, if someone does something silly like turn off all the modules or habit not scanned for anything or not scan for all points. The reporters and zeta, the report we just say Dove and abilities found. And therefore, you think that there are no vulnerabilities. Bow, like the reality of it. A lot of vulnerabilities. But because of configuration settings, it is not seen in this vulnerability scanners as well. Nick dues or the one where we talked about earlier was an O1 is a picture to boost the being bought. And so there are underground forums for doing that. As for exploitation, there are a number of exploitation tools out there. So so we just went from nurses, which is a vulnerability scanning tool, to exploitation tools. And for exploitation Tools, there are three main tools out there. The number one beam, let us wait, and that's something that we're going to do in our lab assignments. Just Metasploit, core impact in the mid-80s Canvas. They all pretty much based on Metasploit, but they're run by three different companies. Immunity canvas. It's kind of like a Metasploit with a really good GUI. Here's a picture of a really old version of immunity Canvas. But essentially it's like Metasploit with GUI episode. It's not an immunity canvas and core impact or kinda like that. And they also cost a lot of money. Metasploit has a, has a open source version and they also have a commercial version as well, made by the company Rapid Seven, which the creator of metasploit actually you create a company Rapid Seven, to sell the product and services. But most places, what we're going to focus on today, because mirrors play is pre-installed on Kali Linux, and you'll be required to use it for your lab assignments. The first thing to know about Metasploit is that Metasploit is really a framework, as in it's a framework used for building pieces upon it. In the framework kind of looks like this. But it, it doesn't matter to us. The point I want to point out is that Metasploit as allows many things to be plugged into it, including experts. So over here you see there has little notation for exploits. And when you get into better spot, you'll find that a lot things has something that looks like a directory structure in it. For example. Say you're trying to exploit a vulnerability and you're trying to load a vulnerability and you will see that it looks like a directory structure. And that's, that's because they actually, yes. So someone could actually exploit dumping into the directory and now it's available for use by Metasploit. And people compete over this. You can buy and sell exploits. People pay like couple of 100 bucks to write a better support exploit for some obscure vulnerability out there. And actually that's normally if you just make some money writing experts. Let's go over some definitions. When a abilities, when our bodies are, when abilities as a weakness that can be exploited. And exploit is something that takes advantage of a vulnerability. Payload. Now Metasploit specific terms. Payload. Payload is the code that is being delivered by the exploit. So in terms of metasploit, days, one piece of code to exploit it. So there's some code used to exploit a vulnerability. Then what happens after the exploit is the payload. The payload is something that's central law of the exploit. In order to do something, the most common payloads or something to give you a Command Prompt. Really. So the payload will have some sort of code on it to open a command prompt. Or it maybe hasn't really small shower in it or something like that that allows interaction with the target host. The motherboard payloads is better interpreter and it's a fully functional shout that has a lot of capabilities built in to it. Encoders are way to advocate payloads so that antivirus and intrusion detection system detected. So encoders basically take something and change around such that the edge of it doesn't match it. Traditional antivirus. And when I'm in a traditional antivirus, I mean antivirus from the old days. The old days of antivirus where it's a basic hash or some sort of string search on something and it matches something, it detects an iterate, the old-style, not the new style antivirus, right? Today's antivirus, which has heuristics and behaviors in order to detect malware. But encoders can just change the signature of the payload. So anti-virus both to play detected if it's certainly just based on some sort of a string or something, some type of search in it. And auxiliary models or additional modules and Metasploit. I believe this one to take a screenshot that you'll be asked to do so in the lab assignments. And in terms of payloads, There are a number of types of payloads. So again, payloads is a term used for FDA exploit something. What kind of code do you give in? What do you give in to do something? And there are three main types of payloads. Well, there are a lot of them, but there are three main types that we care about of payloads. The first type of payload. Inline, inline payload. It's a payload that goes right with the exploit. It gets exploited. The payload is inline with the exploit, and therefore you get a command prompt or something like that. So in order for the inline payload to work, the buffer or wherever there has been exploited in the target system, has to be large enough to hold the shell code or wherever in the payload. So typically, inline payloads are very small because it has to fit in the buffer used to exploit the vulnerability. Then there's another type of pedal is caught staged stage payload work like this. You send an exploit and export console payload that has just enough capability to allow, to open a port and allow additional code to come through. Open support and allows additional code to be sent through. So that's the stage that is more than one set of code is sent at the same time. That allows that the initial payload to be really, really small. So a payload so small that it really, the only purpose that has is to allow additional code to be sent in to the target. And then there's the reverse payloads. And these are the ones that we really care about because very often use to target people behind firewalls and users behind like gateways and such, which is almost everybody. And reverse payload system works like this. You send the exploit, you send the payload. Payload. It's purpose is to connect back out to the firewall, back to the attacker and then get additional code. In your lab assignment. I recommend that you use a perverse payload, right? And it does work. I tested out. And because that is exactly how it normally works, you attack a target and then the target will revert back to you and open a connection back to the attacker in order to open a command prompt and such. And then there's other types of specific types of payloads. There's no access to go pass some sort protection pass of x, which is then I eating some IPV6 and then this meta Jupiter. But interpreter is a really powerful commands that has a lot. Notice it does have a number of interfaces, but the one that we're using is MSF council. So let me switch screens here and show a demonstration of what you would do in various points. Switch screens. Alright, so I have my Kali Linux here. Now in order to combat terminal, which is over here, a terminal. And then MSF council. Msf counsel, you hit return. And if this is the first time you are running on the host, it will take a little while to load. So this is Metasploit and there's some useful commands you can use, like for example, help. Now, we care about Metasploit by attacking subserve vulnerability. So the first thing is, well, you had to find someone or ability. We could do that with Metasploit because it has built into it. But in our class, please use nmap to find someone I abilities. Then. Then once you've found a vulnerability, you want to exploit it using, you can exploited by, well, first, you find a vulnerability that you want to use. That we will talk about the iTunes vulnerability, a few broad scope. So let me see if there are any iTunes vulnerabilities here. So in order to do that, I used to search command, to search iTunes. Search iTunes. And from there, it will show me all of the exploits that have the word iTunes in it. So I came up with three of them over here, is three of them right here. And you notice that these exploit looks like they're in directories. They actually are. So let's say I want to talk about the Apple iTunes playlist vulnerability. So if I want to use this exploit, I just copy it or even type it in. So I do copy. And I go use and I paste this into it. So use this exploit. Once I hit Return here, you'll notice that my command prompt has changed. Now I am in the exploit area of metasploit. The next thing I want to do is I want to set all my options correctly. In order to do that, I do Show Options. Show Options. I hit return, and it shows all the options I need to set in order for this exploit to work. For example, sees that i have a quiet setting here for server host and server port. And the other ones are not required, so I don't have to set it for these required options. I'm going to set the options right? Instances demo. I'm not really explaining and set it to anything doesn't matter to me. So I do set server host to be 1010110 times. Something up here, hit return. Okay, and I see that server host option has been set to 1010110. I do Show Options again. And then from here, I can double check that all my options for set correctly here. And I see that I set all the required options. Now the next thing I want to do, now dice at the Exploit. I want to choose what payload I want to use in order to T. Then I use the command show payloads, show payloads, show payloads, and hit return. Now show panels only shows the payloads that supported by this exploit. So you won't get all pedals, you only get the one sized portraits. And from here, I want to use some to manage triple-A payload. If it works. The Met attributed Plato is the mother of our payload, is the payload has advanced capabilities to, has advanced capabilities to go through it and see which ones are better, better temperature once I estimate to scroll through. So I want to do a different way. So I'm gonna do use, Excuse me, set payload, set payload windows, met Jupiter. Okay? And this showed me all the bits interpreter pedals are. And what I did here is I use tab, right? So in Linux it could use tab for auto-complete. So when I hit tab here, a completed this building better interpreter. And then when I hit tab again, it show me all the other options I have. Dy could use but interpreter for and now I can choose one. Now the thing is, sometimes they work, sometimes they don't know, they all have some type. Some sums work better than others. And this could be a number of reasons. Could be the type of buffer, the type of exploit that the type of vulnerability being exploited. So just because one doesn't work, doesn't mean another one doesn't work. So I'm just going to choose one. I can't say which one's better, right? But I'm going to choose this one here. Let me choose this one. Copy. And actually I already have it here. Reverse tcp. And I hit Tab for autocomplete. I hit return and I set the payload to be death. Again. Now is to show options to make sure they have all the options set. And it looks like or the affluence that upset when I need this loco host. And I'll just set the local host to be something, set L host to be. While I'm just making something up here. Ten, that 1000, DAT 200, again, this demo. So I'm just making something up. Show options again, right? So I made sure that the host has set show options just to make sure I got everything correctly. So here's all the options. Top one hears for the Exploit, I made all the required options. Here's the payload I made all require options and I'm ready to do my Export. Now, I just typing exploit and hear something went wrong because I was just shooting off numbers. But if the exploit work, you will have a command prompt or something like that, and then you can continue on from there. Again, the absolute best resource for doing this is better split, unleashed. The mismatch my screens back to the other screen. And it goes through the same options. And actually that's it. Again, we just did something like this, right? So the idea here is that a phishing email sent to user, the user clicks on it, then, which makes a connection outside from their files downloaded the user clicks on a again, I choose because exploit opens a reverse shell back outside to the attacker. And to get a better idea of this, please go ahead and use, Take a look at let us playlist. Thank you for viewing this video. Please have a wonderful day. Bye."